<!DOCTYPE html>
<html>
<head>
    <title>üêç GrabzSlither.io</title>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            overflow: hidden; 
            background: #2d2d2d;
            font-family: Arial, sans-serif;
        }
        canvas { 
            display: block; 
            background: radial-gradient(circle, #1a1a1a 0%, #0d0d0d 100%);
        }
        #ui {
            position: fixed;
            top: 20px;
            left: 20px;
            color: #fff;
            font-size: 24px;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.8);
            z-index: 10;
        }
        #leaderboard {
            position: fixed;
            top: 20px;
            right: 20px;
            background: rgba(0,0,0,0.7);
            padding: 15px;
            border-radius: 10px;
            color: #fff;
            min-width: 200px;
        }
        .leader {
            padding: 5px;
            margin: 3px 0;
            display: flex;
            justify-content: space-between;
        }
        #gameOver {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.9);
            padding: 40px;
            border-radius: 20px;
            text-align: center;
            color: #fff;
            display: none;
        }
        #gameOver h1 { font-size: 3em; margin-bottom: 20px; color: #ff4444; }
        #gameOver button {
            padding: 15px 40px;
            font-size: 1.5em;
            background: #4ade80;
            border: none;
            border-radius: 10px;
            cursor: pointer;
            margin-top: 20px;
        }
        #gameOver button:hover { background: #22c55e; }
    </style>
</head>
<body>
    <canvas id="game"></canvas>
    <div id="ui">
        <div>Length: <span id="length">10</span></div>
        <div>Rank: <span id="rank">1</span>/<span id="total">1</span></div>
    </div>
    <div id="leaderboard">
        <h3 style="text-align: center; margin-bottom: 10px;">üèÜ TOP 10 üèÜ</h3>
        <div id="leaders"></div>
    </div>
    <div id="gameOver">
        <h1>üíÄ GAME OVER üíÄ</h1>
        <div style="font-size: 2em; margin: 20px 0;">Your Length: <span id="finalLength"></span></div>
        <div style="font-size: 1.5em;">Rank: <span id="finalRank"></span></div>
        <button onclick="location.reload()">PLAY AGAIN</button>
    </div>
    <div id="startMenu" style="position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%); background: rgba(0,0,0,0.95); padding: 50px; border-radius: 20px; text-align: center; color: #fff; z-index: 100;">
        <img src="snake.jpg" style="width: 200px; height: 200px; object-fit: contain; margin-bottom: 20px;">
        <h1 style="font-size: 3em; margin-bottom: 30px; color: #4ade80;">GRABZSLITHER.IO</h1>
        <input type="text" id="nameInput" placeholder="Enter your name" maxlength="15" style="width: 100%; padding: 15px; font-size: 1.2em; margin-bottom: 20px; border: none; border-radius: 10px; text-align: center;">
        <div style="margin: 20px 0;">
            <div style="margin-bottom: 10px; font-size: 1.2em;">Choose your color:</div>
            <div style="display: flex; gap: 10px; justify-content: center; flex-wrap: wrap;">
                <div class="colorPick" data-hue="0" style="width: 50px; height: 50px; background: hsl(0, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="30" style="width: 50px; height: 50px; background: hsl(30, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="60" style="width: 50px; height: 50px; background: hsl(60, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="120" style="width: 50px; height: 50px; background: hsl(120, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="180" style="width: 50px; height: 50px; background: hsl(180, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="240" style="width: 50px; height: 50px; background: hsl(240, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="280" style="width: 50px; height: 50px; background: hsl(280, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
                <div class="colorPick" data-hue="320" style="width: 50px; height: 50px; background: hsl(320, 100%, 50%); border-radius: 50%; cursor: pointer; border: 3px solid transparent;"></div>
            </div>
        </div>
        <button id="playBtn" style="padding: 20px 60px; font-size: 1.5em; background: #4ade80; border: none; border-radius: 10px; cursor: pointer; margin-top: 20px; font-weight: bold;">PLAY</button>
    </div>

    <script>
        const canvas = document.getElementById('game');
        const ctx = canvas.getContext('2d');
        canvas.width = window.innerWidth;
        canvas.height = window.innerHeight;

        const WORLD_SIZE = 4000;
        const PELLET_COUNT = 800;
        const BOT_COUNT = 15;

        const snakeEmojis = ['üêç', 'üêâ', 'ü¶é', 'üêä', 'ü¶ñ', 'üê≤', 'ü™±', 'ü¶ï'];
        
        class Snake {
            constructor(x, y, isPlayer = false, name = '', hue = null) {
                this.segments = [{ x, y }];
                this.length = 10;
                this.angle = Math.random() * Math.PI * 2;
                this.speed = 3;
                this.hue = hue !== null ? hue : Math.random() * 360;
                this.isPlayer = isPlayer;
                this.name = name || `${snakeEmojis[Math.floor(Math.random() * snakeEmojis.length)]} Bot${Math.floor(Math.random() * 1000)}`;
                this.alive = true;
                this.invincible = isPlayer ? 60 : 0; // 1 second spawn protection for player
            }

            update(targetX, targetY) {
                if (!this.alive) return;

                if (this.invincible > 0) this.invincible--;

                if (this.isPlayer) {
                    const dx = targetX - this.segments[0].x;
                    const dy = targetY - this.segments[0].y;
                    this.angle = Math.atan2(dy, dx);
                } else {
                    // Bot AI
                    if (Math.random() < 0.02) {
                        this.angle += (Math.random() - 0.5) * 0.5;
                    }
                    
                    // Find nearest pellet
                    let nearest = null;
                    let minDist = Infinity;
                    pellets.forEach(p => {
                        const dist = Math.hypot(p.x - this.segments[0].x, p.y - this.segments[0].y);
                        if (dist < minDist && dist < 200) {
                            minDist = dist;
                            nearest = p;
                        }
                    });
                    
                    if (nearest) {
                        const dx = nearest.x - this.segments[0].x;
                        const dy = nearest.y - this.segments[0].y;
                        const targetAngle = Math.atan2(dy, dx);
                        const diff = targetAngle - this.angle;
                        this.angle += Math.sign(diff) * Math.min(Math.abs(diff), 0.1);
                    }
                }

                const head = this.segments[0];
                const newHead = {
                    x: head.x + Math.cos(this.angle) * this.speed,
                    y: head.y + Math.sin(this.angle) * this.speed
                };

                // Wrap around world
                newHead.x = (newHead.x + WORLD_SIZE) % WORLD_SIZE;
                newHead.y = (newHead.y + WORLD_SIZE) % WORLD_SIZE;

                this.segments.unshift(newHead);
                while (this.segments.length > this.length) {
                    this.segments.pop();
                }
            }

            draw(camX, camY) {
                if (!this.alive) return;

                // Spawn protection visual
                if (this.invincible > 0) {
                    ctx.globalAlpha = 0.5 + Math.sin(Date.now() / 100) * 0.3;
                }

                ctx.shadowBlur = 10;
                ctx.shadowColor = `hsl(${this.hue}, 100%, 50%)`;

                for (let i = this.segments.length - 1; i >= 0; i--) {
                    const seg = this.segments[i];
                    const screenX = seg.x - camX + canvas.width / 2;
                    const screenY = seg.y - camY + canvas.height / 2;

                    const radius = i === 0 ? 12 : 8;
                    const gradient = ctx.createRadialGradient(screenX, screenY, 0, screenX, screenY, radius);
                    gradient.addColorStop(0, `hsl(${this.hue}, 100%, 60%)`);
                    gradient.addColorStop(1, `hsl(${this.hue}, 100%, 40%)`);

                    ctx.fillStyle = gradient;
                    ctx.beginPath();
                    ctx.arc(screenX, screenY, radius, 0, Math.PI * 2);
                    ctx.fill();

                    if (i === 0) {
                        // Eyes
                        ctx.fillStyle = '#fff';
                        const eyeAngle = this.angle;
                        const eyeOffset = 5;
                        ctx.beginPath();
                        ctx.arc(screenX + Math.cos(eyeAngle + 0.3) * eyeOffset, 
                               screenY + Math.sin(eyeAngle + 0.3) * eyeOffset, 3, 0, Math.PI * 2);
                        ctx.arc(screenX + Math.cos(eyeAngle - 0.3) * eyeOffset, 
                               screenY + Math.sin(eyeAngle - 0.3) * eyeOffset, 3, 0, Math.PI * 2);
                        ctx.fill();
                    }
                }

                ctx.shadowBlur = 0;
                ctx.globalAlpha = 1;

                // Name
                if (this.segments[0]) {
                    const head = this.segments[0];
                    const screenX = head.x - camX + canvas.width / 2;
                    const screenY = head.y - camY + canvas.height / 2;
                    ctx.fillStyle = '#fff';
                    ctx.font = 'bold 14px Arial';
                    ctx.textAlign = 'center';
                    ctx.fillText(this.name, screenX, screenY - 20);
                }
            }

            checkCollision(snakes) {
                if (this.invincible > 0) return false; // Spawn protection
                
                const head = this.segments[0];
                
                for (let snake of snakes) {
                    if (!snake.alive) continue;
                    const startIdx = snake === this ? 10 : 0; // Don't collide with own head
                    
                    for (let i = startIdx; i < snake.segments.length; i++) {
                        const seg = snake.segments[i];
                        const dist = Math.hypot(head.x - seg.x, head.y - seg.y);
                        if (dist < 10) {
                            return true;
                        }
                    }
                }
                return false;
            }
        }

        class Pellet {
            constructor() {
                this.x = Math.random() * WORLD_SIZE;
                this.y = Math.random() * WORLD_SIZE;
                this.hue = Math.random() * 360;
                this.radius = 4;
            }

            draw(camX, camY) {
                const screenX = this.x - camX + canvas.width / 2;
                const screenY = this.y - camY + canvas.height / 2;

                if (screenX < -20 || screenX > canvas.width + 20 || 
                    screenY < -20 || screenY > canvas.height + 20) return;

                ctx.fillStyle = `hsl(${this.hue}, 100%, 50%)`;
                ctx.beginPath();
                ctx.arc(screenX, screenY, this.radius, 0, Math.PI * 2);
                ctx.fill();
            }
        }

        let player = null;
        let snakes = [];
        let pellets = [];
        let mouseX = canvas.width / 2;
        let mouseY = canvas.height / 2;
        let gameStarted = false;
        let selectedHue = 0;

        // Color picker
        document.querySelectorAll('.colorPick').forEach(el => {
            el.addEventListener('click', () => {
                document.querySelectorAll('.colorPick').forEach(e => e.style.border = '3px solid transparent');
                el.style.border = '3px solid #fff';
                selectedHue = parseInt(el.dataset.hue);
            });
        });
        document.querySelector('.colorPick').style.border = '3px solid #fff';

        // Start game
        document.getElementById('playBtn').addEventListener('click', () => {
            const name = document.getElementById('nameInput').value.trim();
            if (!name) {
                alert('Please enter a name!');
                return;
            }
            
            document.getElementById('startMenu').style.display = 'none';
            gameStarted = true;
            
            player = new Snake(WORLD_SIZE / 2, WORLD_SIZE / 2, true, 'üëë ' + name, selectedHue);
            snakes = [player];
            
            // Create bots
            for (let i = 0; i < BOT_COUNT; i++) {
                snakes.push(new Snake(
                    Math.random() * WORLD_SIZE,
                    Math.random() * WORLD_SIZE,
                    false
                ));
            }
            
            // Create pellets
            for (let i = 0; i < PELLET_COUNT; i++) {
                pellets.push(new Pellet());
            }
            
            gameLoop();
        });

        canvas.addEventListener('mousemove', (e) => {
            mouseX = e.clientX;
            mouseY = e.clientY;
        });

        function gameLoop() {
            if (!gameStarted || !player) return;
            
            ctx.fillStyle = 'rgba(13, 13, 13, 0.3)';
            ctx.fillRect(0, 0, canvas.width, canvas.height);

            if (!player.alive) {
                document.getElementById('gameOver').style.display = 'block';
                document.getElementById('finalLength').textContent = player.length;
                const rank = snakes.filter(s => s.alive && s.length > player.length).length + 1;
                document.getElementById('finalRank').textContent = rank;
                return;
            }

            const camX = player.segments[0].x;
            const camY = player.segments[0].y;

            // Draw pellets
            pellets.forEach(p => p.draw(camX, camY));

            // Update and draw snakes
            snakes.forEach(snake => {
                if (snake.isPlayer) {
                    snake.update(camX + mouseX - canvas.width / 2, camY + mouseY - canvas.height / 2);
                } else {
                    snake.update();
                }
                snake.draw(camX, camY);
            });

            // Check collisions
            snakes.forEach(snake => {
                if (!snake.alive) return;
                
                if (snake.checkCollision(snakes)) {
                    snake.alive = false;
                    // Drop pellets
                    for (let i = 0; i < snake.length / 2; i++) {
                        const seg = snake.segments[Math.floor(Math.random() * snake.segments.length)];
                        if (seg) {
                            const p = new Pellet();
                            p.x = seg.x;
                            p.y = seg.y;
                            pellets.push(p);
                        }
                    }
                }
            });

            // Eat pellets
            snakes.forEach(snake => {
                if (!snake.alive) return;
                const head = snake.segments[0];
                
                pellets = pellets.filter(p => {
                    const dist = Math.hypot(head.x - p.x, head.y - p.y);
                    if (dist < 15) {
                        snake.length += 1;
                        return false;
                    }
                    return true;
                });
            });

            // Respawn pellets
            while (pellets.length < PELLET_COUNT) {
                pellets.push(new Pellet());
            }

            // Respawn bots
            snakes = snakes.filter(s => s.isPlayer || s.alive);
            while (snakes.length < BOT_COUNT + 1) {
                snakes.push(new Snake(
                    Math.random() * WORLD_SIZE,
                    Math.random() * WORLD_SIZE,
                    false
                ));
            }

            // Update UI
            document.getElementById('length').textContent = player.length;
            const aliveSnakes = snakes.filter(s => s.alive);
            const rank = aliveSnakes.filter(s => s.length > player.length).length + 1;
            document.getElementById('rank').textContent = rank;
            document.getElementById('total').textContent = aliveSnakes.length;

            // Leaderboard
            const top = aliveSnakes.sort((a, b) => b.length - a.length).slice(0, 10);
            document.getElementById('leaders').innerHTML = top.map((s, i) => 
                `<div class="leader" style="${s.isPlayer ? 'color: #4ade80; font-weight: bold;' : ''}">
                    <span>${i + 1}. ${s.name}</span>
                    <span>${s.length}</span>
                </div>`
            ).join('');

            requestAnimationFrame(gameLoop);
        }

        // Allow Enter key to start
        document.getElementById('nameInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') document.getElementById('playBtn').click();
        });
    </script>
</body>
</html>
